<!DOCTYPE html>
<html lang="en">
 <head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>
    keygenme-py 
  </title>
      <!---Stylesheet--->
      <link rel="styleSheet" href="./style.css">
  </head>
 <body>
   <div class="header">
    <h1><strong>Challenge Name</strong>: keygenme-py</h1>
    <img src="../Reverse-engineering.png" alt="reverseEngineering" id="headerImg">
    <br>
  <ul>
    <li><h3><strong>Description</strong>: <em>(none)</em></h3></li>
    <li><h3><em><strong>hint</strong>: (none)</em></h3></li>
  </ul>
    
   </div>

   <div class="solution">
     <h3>Solution:</h3>
    <h4>Lets run <em>"keygenme-trail.py"</em> file</h4> 
   <p><strong>Output:</strong></p>
      <br>
      <img src="./keygen.png" alt="Output">
      <br>
      <p>
      After execution of the program ,we see a menu with four options.<strong>On choosing option (a)</strong> program asks us to enter the star name.
      <strong>On choosing option(b)</strong> program asks us to buy full version.<strong>On choosing option(c)</strong> program asks us to enter <strong>license key</strong>
      </p>
    <h4>Lets look at the code!</h4>
    <img src="./patialFlag.png" alt="partial flag" id="simulator">
    <p>As you can see there are two variables "key_part_static1_trial" and "key_part_dynamic1_trial". Our flag has been divided and stored seperately into these two variables.
      <br>
      <br>
      We already have former part of the flag i.e <strong>"picoCTF{1n_7h3_|<3y_of_"</strong>
      <br>
      <br>
      All we need to do is find the latter part.
      <h4>Let's look at "enter_license" and "check_ key" functions</h4>
      <img src="./enterLicense.png" alt="enter_license function">
      <br>
      <img src="./userNameTrail.png" alt="username">
      <p>So here we can see that there's "user_key" variable where user input will be stored and "bUsername_trail" variable which stores <strong>b"FREEMAN"</strong> 
        string.Then this two values are passed to "check_key" function.
      </p>
      <br>
      <img src="./check_key1.png" alt="check key 1">
      <p>This function requires two values, first "key" variable that holds <strong>user entered license key</strong>
        and "user_name" variable that holds <strong>"FREEMAN"</strong>.Along with this two variables there's third one "key_full_template_trial" which
        holds <strong>"picoCTF{1n_7h3_|<3y_of_xxxxxxxx}"</strong>
        <br>
        Here we can say that <strong>license key is the flag</strong> cause length of "key" is compared with "key_full_template_trail"
        and after that former part of flag gets compared with input license key.
        <br>
        After that there's block of code which has consecutive "if-else" statements where rest of the flag gets compared
        <br>
        <br>
        <strong>Let's make changes to this block of code</strong>, instead of returning "false" lets print <strong>"hashlib.sha256(username_trial).hexdigest()[i]"</strong> and then increment the "i" value.
      </p>
        <h4>Code after Changes</h4>
        <img src="./check_trail2.png" alt="check key">
        <br>
        <p>So let's run the code after doing all the required changes mentioned above and choose <strong>option(c)</strong>
        and enter <strong>"picoCTF{1n_7h3_|<3y_of_xxxxxxxx}"</strong> as license key</p>
        <br>
        <h4>Output</h4>
        <img src="./solution.png" alt="solution">
        <p>Voil√†!!! remaing part of the flags gets displayed</p>

      <br>
      <br>
    </div>
    <p id="flag">Flag:<strong>picoCTF{1n_7h3_|<3y_of_0d208392}</strong></p>
   
		<footer>
      <p>Author: Harshal Sabale</p>
    </footer>
 </body>
</html>
 
